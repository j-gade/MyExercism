Third iteration: renamed fields and variables, simplified some constructs.
I left the asserts() in.
